import turtle as t  # å¼•å…¥turtleæ¨¡å—ï¼Œå¹¶å°†å…¶é‡å‘½åä¸ºt
from turtle import *  # ä»turtleæ¨¡å—ä¸­å¯¼å…¥æ‰€æœ‰å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨turtleçš„å‡½å¼ï¼Œä¸éœ€è¦åŠ å‰ç¼€
import random as r  # å¼•å…¥randomæ¨¡å—ï¼Œå¹¶å°†å…¶é‡å‘½åä¸ºr


def set_initial_state(tree_height):
    """è®¾ç½®åˆå§‹çŠ¶æ€"""
    title("ğŸ„")
    speed(0)  # è®¾ç½®ç”»ç¬”çš„é€Ÿåº¦ä¸º0ï¼Œæœ€å¿«ï¼Œä¹Ÿå¯ä»¥è®¾å®šä¸º fastest
    screensize(bg='black')  # è®¾ç½®å±å¹•çš„å¤§å°ï¼ŒèƒŒæ™¯ä¸ºé»‘è‰²
    left(90)  # ç”»ç¬”å‘å·¦æ—‹è½¬90åº¦
    forward(3 * tree_height)  # æŒ‰ç…§å•ä½é•¿åº¦nçš„3å€é•¿åº¦å‘å‰ç§»åŠ¨
    color("orange", "yellow")  # è®¾ç½®ç”»ç¬”çš„é¢œè‰²ï¼Œç”»çº¿ï¼ˆè½®å»“ï¼‰çš„é¢œè‰²ä¸ºæ©™è‰²ï¼Œå¡«å……çš„é¢œè‰²ä¸ºé»„è‰²


def draw_star(tree_height):
    """ç”»ä¸€ä¸ªäº”è§’æ˜Ÿ"""
    begin_fill()  # å¼€å§‹å¡«å……é¢œè‰²
    left(126)  # ç”»ç¬”å‘å·¦æ—‹è½¬126åº¦
    for i in range(5):  # å¾ªç¯5æ¬¡ï¼Œç”»äº”è§’æ˜Ÿçš„äº”ä¸ªè¾¹
        forward(tree_height / 5)  # å‘å‰ç§»åŠ¨é•¿åº¦ä¸ºnçš„äº”åˆ†ä¹‹ä¸€
        right(144)  # å³è½¬144åº¦ï¼Œç”»äº”è§’æ˜Ÿçš„å†…è§’
        forward(tree_height / 5)  # å‘å‰ç§»åŠ¨é•¿åº¦ä¸ºnçš„äº”åˆ†ä¹‹ä¸€
        left(72)  # ç”»ç¬”å‘å·¦æ—‹è½¬72åº¦ï¼Œç”»äº”è§’æ˜Ÿçš„å¤–è§’
    end_fill()  # å¡«å……é¢œè‰²å®Œæ¯•
    right(126)  # ç”»ç¬”å‘å³æ—‹è½¬126åº¦


def drawlight():
    """åœ¨æ ‘å¹²ä¸Šéšæœºç”»ç¯"""
    # 30ä¸ªç‚¹å†…æœ‰ä¸€ä¸ªæ˜¯å½©ç¯ï¼Œå¦‚æœè§‰å¾—å½©ç¯å¤ªå¤šï¼Œå¯ä»¥æŠŠå–å€¼èŒƒå›´åŠ å¤§ä¸€äº›ï¼Œå¯¹åº”çš„ç¯å°±ä¼šå°‘ä¸€äº›
    # æ”¹å˜é¢œè‰²ï¼Œç”»ä¸€ä¸ªå½©ç‚¹
    if r.randint(0, 30) == 0:
        color('tomato')  # å®šä¹‰ç¬¬ä¸€ç§é¢œè‰²
        circle(6)  # å®šä¹‰å½©ç¯å¤§å°
    elif r.randint(0, 30) == 1:
        color('orange')  # å®šä¹‰ç¬¬äºŒç§é¢œè‰²
        circle(3)  # å®šä¹‰å½©ç¯å¤§å°
    else:
        color('dark green')  # å…¶ä½™çš„é¢œè‰²ä¸ºæ·±ç»¿è‰²ï¼Œä»£è¡¨æ ‘æ


def draw_tree(tree_height):
    """ç”»æ ‘çš„ä¸»ä½“éƒ¨åˆ†"""
    color("dark green")  # è®¾ç½®ç”»ç¬”é¢œè‰²ä¸ºæ·±ç»¿è‰²
    backward(tree_height * 4.8)  # å‘åç§»åŠ¨å•ä½é•¿åº¦nçš„4.8å€ï¼Œä¸ºäº†ç”»æ ‘å¹²


def tree(d, s):
    """ä»¥é€’å½’çš„æ–¹å¼ç”»æ ‘çš„æå¹²"""
    if d <= 0:
        return
    forward(s)  # å‘å‰ç§»åŠ¨
    tree(d - 1, s * .8)
    right(120)
    tree(d - 3, s * .5)
    # åŒæ—¶è°ƒç”¨å°å½©ç¯çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”»å®Œä¸€ä¸ªæ ‘æåç”»ä¸€ä¸ªå°å½©ç¯
    drawlight()
    right(120)
    tree(d - 3, s * .5)
    right(120)
    backward(s)


def draw_decorations():
    """ç”»æ ‘ä¸‹çš„è£…é¥°å“"""
    for i in range(200):
        a = 200 - 400 * r.random()
        b = 10 - 20 * r.random()
        up()  # æç¬”
        forward(b)
        left(90)
        forward(a)
        down()  # è½ç¬”
        if r.randint(0, 1) == 0:
            color('tomato')
        else:
            color('wheat')
        circle(2)
        up()
        backward(a)
        right(90)
        backward(b)


def write_text(greeting):
    """
    åœ¨ç”»å¸ƒä¸­å¤®ä¹¦å†™åœ£è¯ç¥ç¦
    å‚æ•°: greeting -- ç”¨æˆ·è¾“å…¥çš„åœ£è¯ç¥ç¦å­—ç¬¦ä¸²
    """
    # æ ¹æ®ç”¨æˆ·çš„è¾“å…¥é•¿åº¦å†³å®šä½¿ç”¨çš„å­—ä½“å¤§å°ã€‚ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦è¶Šå¤šï¼Œå­—ä½“è¶Šå°
    font_size = 40 - len(greeting)
    # å¦‚æœç”¨æˆ·æ²¡æœ‰è¾“å…¥ç¥ç¦ï¼Œåˆ™ä¼šæ˜¾ç¤ºé»˜è®¤ç¥ç¦è¯­
    if not greeting:
        greeting = "Merry Christmas!"
    t.color("dark red", "red")  # å®šä¹‰å­—ä½“é¢œè‰²
    # å®šä¹‰æ–‡å­—ã€ä½ç½®ã€å­—ä½“ã€å¤§å°
    t.write(greeting, align="center", font=("Comic Sans MS", font_size, "bold"))


def draw_snow():
    """ç”»é›ªèŠ±"""
    t.ht()  # éšè—ç”»ç¬”çš„turtleå½¢çŠ¶
    t.pensize(2)  # è®¾ç½®ç”»ç¬”çš„å®½åº¦
    for i in range(200):  # éšæœºç”»200ä¸ªé›ªèŠ±
        t.pencolor("white")  # è®¾ç½®ç”»ç¬”ä¸ºç™½è‰²
        t.pu()  # æç¬”
        t.setx(r.randint(-350, 350))  # éšæœºè®¾ç½®Xåæ ‡
        t.sety(r.randint(-100, 350))  # éšæœºè®¾ç½®Yåæ ‡ï¼Œæ³¨æ„é›ªèŠ±ä¸€èˆ¬åœ¨åœ°ä¸Šä¸ä¼šè½ä¸‹ï¼Œæ‰€ä»¥ä¸ä¼šä»å¤ªå°çš„çºµåº§è½´å¼€å§‹
        t.pd()  # è½ç¬”
        dens = 6  # å®šä¹‰é›ªèŠ±çš„ç“£æ•°
        snow_size = r.randint(1, 10)  # å®šä¹‰é›ªèŠ±çš„å¤§å°
        for j in range(dens):  # ç”»æ¯ä¸€ç“£é›ªèŠ±
            t.fd(int(snow_size))
            t.backward(int(snow_size))
            t.right(int(360 / dens))  # è½¬åŠ¨ä¸€å®šçš„è§’åº¦


def run():
    """
    æ‰§è¡Œæ•´ä¸ªç»˜å›¾ç¨‹åº
    """
    # è·å–ç”¨æˆ·è¾“å…¥
    greeting = input("è¯·è¾“å…¥åœ£è¯ç¥ç¦ï¼ˆæœ€å¤šåªèƒ½è¾“å…¥10ä¸ªå­—ç¬¦ï¼‰: ")
    # å¦‚æœç”¨æˆ·è¾“å…¥çš„å­—ç¬¦è¶…è¿‡10ä¸ªï¼Œæç¤ºç”¨æˆ·é‡æ–°è¾“å…¥
    while len(greeting) > 10:
        greeting = input("ç¥ç¦è¯­çš„å­—ç¬¦æ•°è¶…è¿‡äº†10ä¸ªã€‚è¯·é‡æ–°è¾“å…¥ï¼š")

    tree_height = 100.0  # æ ‘çš„é«˜åº¦ï¼Œä½œä¸ºç»˜ç”»çš„åŸºæœ¬å•ä½
    set_initial_state(tree_height)
    draw_star(tree_height)
    draw_tree(tree_height)
    tree(15, tree_height)  # å…·ä½“è°ƒç”¨treeå‡½æ•°ï¼Œç”»å‡ºä¸€æ£µæ ‘
    backward(tree_height / 2)
    draw_decorations()
    # å°†ç”¨æˆ·è¾“å…¥çš„ç¥ç¦è¯­ä¼ é€’ç»™write_textå‡½æ•°
    write_text(greeting)
    draw_snow()
    # ç»“æŸï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œï¼Œå¦åˆ™çª—å£ä¼šç›´æ¥å…³é—­
    t.done()


if __name__ == "__main__":
    run()  # å½“è„šæœ¬è¿è¡Œæ—¶ï¼Œè°ƒç”¨è¿è¡Œç”»å›¾çš„å‡½æ•°
